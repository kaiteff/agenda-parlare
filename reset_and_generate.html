<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <title>Resetear y Generar Datos</title>
</head>

<body>
    <h1>âš ï¸ Resetear y Generar Datos Limpios</h1>
    <p><strong>ADVERTENCIA:</strong> Esto borrarÃ¡ TODOS los pacientes y citas existentes.</p>
    <p>Luego crearÃ¡:</p>
    <ul>
        <li><strong>20 pacientes para Diana</strong> con 8 citas semanales cada uno (160 citas)</li>
        <li><strong>20 pacientes para Sam</strong> con 8 citas semanales cada uno (160 citas)</li>
        <li>Total: <strong>40 pacientes y 320 citas</strong></li>
    </ul>

    <button id="resetBtn"
        style="padding: 20px; font-size: 18px; background: #F44336; color: white; border: none; border-radius: 5px; cursor: pointer; margin-top: 20px;">
        ğŸ—‘ï¸ Borrar Todo y Generar Datos Nuevos
    </button>

    <div id="output"
        style="margin-top: 20px; padding: 20px; background: #f5f5f5; border-radius: 5px; font-family: monospace; white-space: pre-wrap; max-height: 500px; overflow-y: auto;">
    </div>

    <script type="module">
        // Precargar Firebase primero
        import './js/firebase.js';
        import { resetAndGenerate } from './js/reset_and_generate.js';

        // Esperar a que el DOM estÃ© listo
        document.getElementById('resetBtn').addEventListener('click', async () => {
            const output = document.getElementById('output');
            const btn = document.getElementById('resetBtn');

            if (!confirm('âš ï¸ Â¿ESTÃS SEGURO? Esto borrarÃ¡ TODOS los pacientes y citas existentes. Esta acciÃ³n NO se puede deshacer.')) {
                return;
            }

            btn.disabled = true;
            btn.textContent = 'Procesando...';
            output.textContent = 'Iniciando proceso...\n';

            // Capturar console.log
            const originalLog = console.log;
            console.log = (...args) => {
                output.textContent += args.join(' ') + '\n';
                output.scrollTop = output.scrollHeight;
                originalLog(...args);
            };

            try {
                await resetAndGenerate();
                output.textContent += '\nâœ… Â¡Proceso completado exitosamente!';
                output.textContent += '\n\nğŸ”„ Recarga la aplicaciÃ³n principal para ver los nuevos datos.';
            } catch (error) {
                output.textContent += '\nâŒ Error: ' + error.message;
                console.error(error);
            } finally {
                console.log = originalLog;
                btn.disabled = false;
                btn.textContent = 'ğŸ—‘ï¸ Borrar Todo y Generar Datos Nuevos';
            }
        });
    </script>
</body>

</html>